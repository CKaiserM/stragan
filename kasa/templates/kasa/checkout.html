{% extends 'base.html' %} 

{% load rest_framework %}
{% block content %}
<div class="container">
  
    <div class="row g-0">
      <div class="col-md-8">
        {% for item in cart_checkout %}
        <div class="card my-3">
          <div class="row g-0">
            <div class="col-md-4">
              <img src="{{item.featured_image.url}}" class="img-fluid rounded-start" alt="{{item.title}}">
            </div>
            <div class="col-md-4">
              <div class="card-body">
                <h5 class="card-title">{{item.title}}</h5>
                <p class="card-text">{{item.price}} zł/ {{item.unit}}</p>
                <p class="card-text">Liczba sztuk:</p>
                <div class="input-group-qty">
                  {% for key, value in cart_quantities.items %}
                    {% if key == item.id|slugify %}
                      {{value}}
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
            </div>
            <div class="col-md-4 text-end p-3">
              <h5 class="card-title">
                {% for key, value in cart_subtotal.items %}
                  {% if key == item.id|slugify %}
                    {{value}} zł
                  {% endif %}
                {% endfor %}
              </h5>
              {% if item.is_on_sale %}
              <p class="card-text">{{item.price}} zł/ {{item.unit}}</p>
              {% else %}
              <p class="card-text">{{item.price_on_sale}} zł/ {{item.unit}}</p>
              {% endif %}
            </div>
          </div>
          
          <div class="row g-0">
            <div class="col-md-12 text-end p-3">
              <div class="m-2">
              <hr/>
              </div>

              <p class="card-text">Z dostawą:
                </p>

            </div>
          </div>
        </div>
        {% endfor %}

        <div class="card">

        
            <div class="card-body">
                <h6 class="card-title text-uppercase">Adres do wysyłki</h6>
                {% if shipping_user %}
                <p class="card-text">{{shipping_user.shipping_house_and_street_no}}</p>
                <p class="card-text">{{shipping_user.shipping_postal_code}} {{shipping_user.shipping_city}}</p>
                <!-- Button trigger modal -->
                  <button type="button" class="btn btn-link" data-bs-toggle="modal" data-bs-target="#shippingaddressChange">ZMIEŃ
                  </button>
                  {% endif %}
              </div>
          </div>

        </div>
        <div class="col-md-4">
          <div class="card m-3">
            <div class="card-body">
              <p class="card-text">Wartość produktów: {{cart_total}}</p>
              <p class="card-text">Dostawa:</p>
              <hr/>
              <p class="card-text">Razem z dostawą: <h5>500 zł</h5></p>
              <a href="{% url 'checkout' %}" type="button" class="btn btn-success w-100">Dostawa i płatność</a>
            </div>
          </div>
        </div>
      </div>
    
  </div>
  {% endblock %}